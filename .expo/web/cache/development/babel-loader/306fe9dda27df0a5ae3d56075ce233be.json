{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/abubakarakram/development/projects/backup bar peakk/client/src/screens/HomeScreen.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport MapComponent from \"../components/MapComponent\";\nimport { getfilteredBusiness, getFavouritesBusinessAction, getNearLocationBusiness, emptyBusiness } from \"../../redux/actions/Business\";\nimport { getVibe } from \"../../redux/actions/Vibe\";\nimport { getAllCategories } from \"../../redux/actions/Category\";\nimport { setUserLocation } from \"../../redux/actions/User\";\nimport * as Location from 'expo-location';\nimport ShowPopupModal from \"../components/popUpModal\";\nimport _, { map } from 'underscore';\nimport Modal from \"../components/Modal\";\nimport OrientationLoadingOverlay from 'react-native-orientation-loading-overlay';\n\nvar _Dimensions$get = Dimensions.get('window'),\n    height = _Dimensions$get.height,\n    width = _Dimensions$get.width;\n\nvar HomeScreen = function (_Component) {\n  _inherits(HomeScreen, _Component);\n\n  var _super = _createSuper(HomeScreen);\n\n  function HomeScreen(props) {\n    var _this;\n\n    _classCallCheck(this, HomeScreen);\n\n    _this = _super.call(this, props);\n\n    _this.getBusinessByCategory = function _callee(category) {\n      var navigation;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.setState({\n                spinner: true\n              });\n\n              navigation = _this.props.navigation;\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(_this.props.getfilteredBusiness(category));\n\n            case 4:\n              _this.setState({\n                spinner: false\n              });\n\n              navigation.navigate('MapScreen', {\n                category: category\n              });\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.selectSpecificBusiness = function (item) {\n      var businesses = _this.props.business.business.businesses;\n      var selectedBusiness = businesses.filter(function (business) {\n        return business.placeId === item.place_id;\n      })[0];\n\n      _this.setState({\n        selectedItem: item,\n        showProfileModal: true,\n        selectedBusiness: selectedBusiness\n      });\n    };\n\n    _this.getNewChangedLocation = function _callee2() {\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(Location.watchPositionAsync({\n                enableHighAccuracy: true,\n                distanceInterval: 100,\n                timeInterval: 5000\n              }, function (newLocation) {\n                var coords = newLocation.coords;\n\n                _this.props.setUserLocation(coords);\n              }, function (error) {\n                return console.log(error);\n              }));\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.getCurrentLocation = function _callee3() {\n      var _await$Location$reque, status, location;\n\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(Location.requestPermissionsAsync());\n\n            case 2:\n              _await$Location$reque = _context3.sent;\n              status = _await$Location$reque.status;\n\n              if (status !== 'granted') {\n                setErrorMsg('Permission to access location was denied');\n              }\n\n              _context3.next = 7;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({\n                accuracy: Location.Accuracy.Balanced\n              }));\n\n            case 7:\n              location = _context3.sent;\n              return _context3.abrupt(\"return\", location);\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.state = {\n      location: null,\n      errorMsg: null,\n      showModal: false,\n      showProfileModal: false,\n      selectedItem: {},\n      selectedBusiness: {},\n      showIndicator: false,\n      spinner: false\n    };\n    return _this;\n  }\n\n  _createClass(HomeScreen, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var location, coords, _await$Promise$all, _await$Promise$all2, _getVibe, isVibeEmpty;\n\n      return _regeneratorRuntime.async(function componentDidMount$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _context4.next = 3;\n              return _regeneratorRuntime.awrap(this.props.emptyBusiness());\n\n            case 3:\n              this.setState({\n                spinner: true\n              });\n              _context4.next = 6;\n              return _regeneratorRuntime.awrap(this.getCurrentLocation());\n\n            case 6:\n              location = _context4.sent;\n              _context4.next = 9;\n              return _regeneratorRuntime.awrap(this.getNewChangedLocation());\n\n            case 9:\n              coords = location.coords;\n              _context4.next = 12;\n              return _regeneratorRuntime.awrap(Promise.all([this.props.getVibe(), this.props.getNearLocationBusiness(coords), this.props.setUserLocation(coords)]));\n\n            case 12:\n              _await$Promise$all = _context4.sent;\n              _await$Promise$all2 = _slicedToArray(_await$Promise$all, 1);\n              _getVibe = _await$Promise$all2[0];\n              setTimeout(function () {\n                _this2.setState({\n                  spinner: false\n                });\n              }, 1000);\n              isVibeEmpty = _.isEmpty(_getVibe);\n              if (isVibeEmpty) this.setState({\n                showModal: false\n              });\n              _context4.next = 20;\n              return _regeneratorRuntime.awrap(this.props.getAllCategories());\n\n            case 20:\n              _context4.next = 22;\n              return _regeneratorRuntime.awrap(this.props.getfilteredBusiness(null, null, null));\n\n            case 22:\n              _context4.next = 24;\n              return _regeneratorRuntime.awrap(this.props.getFavouritesBusinessAction());\n\n            case 24:\n              _context4.next = 29;\n              break;\n\n            case 26:\n              _context4.prev = 26;\n              _context4.t0 = _context4[\"catch\"](0);\n              console.log(\"the error\", _context4.t0);\n\n            case 29:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, this, [[0, 26]], Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var navigation = this.props.navigation;\n      return React.createElement(SafeAreaView, {\n        style: {\n          flex: 1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 9\n        }\n      }, React.createElement(MapComponent, {\n        navigation: navigation,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }\n      }), this.state.showModal && React.createElement(ShowPopupModal, {\n        closeModal: function closeModal() {\n          return _this3.setState({\n            showModal: false\n          });\n        },\n        navigation: this.props.navigation,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 38\n        }\n      }), this.state.showProfileModal && React.createElement(Modal, {\n        item: this.state.selectedItem,\n        businessData: this.state.selectedBusiness,\n        show: this.state.showProfileModal,\n        closeModal: function closeModal() {\n          _this3.setState({\n            showProfileModal: false\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 44\n        }\n      }), React.createElement(OrientationLoadingOverlay, {\n        visible: this.state.spinner,\n        message: \"Loading...\",\n        color: \"white\",\n        indicatorSize: \"large\",\n        messageFontSize: 24,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }\n      }, React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }\n      }, React.createElement(Image, {\n        source: require(\"../../assets/loadingIndicator.gif\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }\n      })))));\n    }\n  }]);\n\n  return HomeScreen;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  var business = state.business,\n      vibe = state.vibe,\n      user = state.user,\n      category = state.category;\n  return {\n    business: business,\n    vibe: vibe,\n    category: category,\n    user: user\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    getNearLocationBusiness: getNearLocationBusiness,\n    getfilteredBusiness: getfilteredBusiness,\n    getVibe: getVibe,\n    emptyBusiness: emptyBusiness,\n    getAllCategories: getAllCategories,\n    setUserLocation: setUserLocation,\n    getFavouritesBusinessAction: getFavouritesBusinessAction\n  }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HomeScreen);\nvar styles = StyleSheet.create({\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#F5FCFF'\n  },\n  welcome: {\n    fontSize: 20,\n    textAlign: 'center',\n    margin: 10\n  },\n  instructions: {\n    textAlign: 'center',\n    color: '#333333',\n    marginBottom: 5\n  },\n  container: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  homeLogo: {\n    flex: 1,\n    height: null,\n    width: '100%',\n    resizeMode: 'cover',\n    borderBottomLeftRadius: 0,\n    borderBottomRightRadius: 0,\n    borderRadius: 15,\n    borderBottomWidth: 0,\n    borderWidth: 1,\n    borderColor: '#dddddd'\n  },\n  ImageButton: {\n    position: 'absolute',\n    top: '25%',\n    left: '5%'\n  },\n  spinnerTextStyle: {\n    color: '#FFF'\n  },\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#F5FCFF'\n  },\n  welcome: {\n    fontSize: 20,\n    textAlign: 'center',\n    margin: 10\n  },\n  instructions: {\n    textAlign: 'center',\n    color: '#333333',\n    marginBottom: 5\n  },\n  spinnerContainer: {\n    position: 'relative',\n    top: '0%',\n    bottom: '40%',\n    left: '35%'\n  },\n  overlaycontainer: _objectSpread(_objectSpread({}, StyleSheet.absoluteFillObject), {}, {\n    backgroundColor: '#000',\n    opacity: 0.3,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    zIndex: 3\n  })\n});","map":{"version":3,"sources":["/Users/abubakarakram/development/projects/backup bar peakk/client/src/screens/HomeScreen.js"],"names":["React","Component","connect","bindActionCreators","MapComponent","getfilteredBusiness","getFavouritesBusinessAction","getNearLocationBusiness","emptyBusiness","getVibe","getAllCategories","setUserLocation","Location","ShowPopupModal","_","map","Modal","OrientationLoadingOverlay","Dimensions","get","height","width","HomeScreen","props","getBusinessByCategory","category","setState","spinner","navigation","navigate","selectSpecificBusiness","item","businesses","business","selectedBusiness","filter","placeId","place_id","selectedItem","showProfileModal","getNewChangedLocation","watchPositionAsync","enableHighAccuracy","distanceInterval","timeInterval","newLocation","coords","error","console","log","getCurrentLocation","requestPermissionsAsync","status","setErrorMsg","getCurrentPositionAsync","accuracy","Accuracy","Balanced","location","state","errorMsg","showModal","showIndicator","Promise","all","setTimeout","isVibeEmpty","isEmpty","flex","require","mapStateToProps","vibe","user","mapDispatchToProps","dispatch","styles","StyleSheet","create","loadingContainer","justifyContent","alignItems","backgroundColor","welcome","fontSize","textAlign","margin","instructions","color","marginBottom","container","homeLogo","resizeMode","borderBottomLeftRadius","borderBottomRightRadius","borderRadius","borderBottomWidth","borderWidth","borderColor","ImageButton","position","top","left","spinnerTextStyle","spinnerContainer","bottom","overlaycontainer","absoluteFillObject","opacity","zIndex"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {\n    View,\n    StyleSheet,\n    SafeAreaView,\n    Dimensions,\n    Image\n} from \"react-native\";\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport MapComponent from '../components/MapComponent';\nimport {getfilteredBusiness, getFavouritesBusinessAction, getNearLocationBusiness, emptyBusiness} from '../../redux/actions/Business';\nimport {getVibe} from '../../redux/actions/Vibe';\nimport { getAllCategories } from '../../redux/actions/Category';\nimport { setUserLocation } from '../../redux/actions/User';\nimport * as Location from 'expo-location';\nimport ShowPopupModal from '../components/popUpModal';\nimport _, { map } from 'underscore';\nimport Modal from '../components/Modal';\nimport OrientationLoadingOverlay from 'react-native-orientation-loading-overlay'\n\nconst { height, width } = Dimensions.get('window')\nclass HomeScreen extends Component {\n\n  constructor(props){\n    super(props);\n    this.state = {\n      location: null,\n      errorMsg: null,\n      showModal: false,\n      showProfileModal: false,\n      selectedItem: {},\n      selectedBusiness: {},\n      showIndicator: false,\n      spinner: false\n    }\n  }\n\n  async componentDidMount(){\n    try{\n      await this.props.emptyBusiness()\n      this.setState({ spinner: true })\n      const location = await this.getCurrentLocation()\n      await this.getNewChangedLocation(); \n      const { coords } = location;\n      const [getVibe] = await Promise.all([ this.props.getVibe(), this.props.getNearLocationBusiness(coords), this.props.setUserLocation(coords)]) \n      setTimeout(()=> {  \n        this.setState({ spinner: false })\n      }, 1000)\n      const isVibeEmpty = _.isEmpty(getVibe);  \n      if(isVibeEmpty)\n        this.setState({ showModal: false })    \n      await this.props.getAllCategories();\n      await this.props.getfilteredBusiness(null, null, null);\n      await this.props.getFavouritesBusinessAction();\n    }catch(error){\n      console.log(\"the error\", error)\n    }\n  }\n\n  getBusinessByCategory = async(category) => {\n    this.setState({ spinner: true })\n    const { navigation } = this.props;\n    await this.props.getfilteredBusiness(category);\n    this.setState({ spinner: false })\n    navigation.navigate('MapScreen',{\n      category\n    })\n  }\n\n  selectSpecificBusiness = (item) => {\n    const { businesses } = this.props.business.business;\n    const selectedBusiness = businesses.filter( (business) => business.placeId === item.place_id )[0]\n    this.setState({ selectedItem: item, showProfileModal: true, selectedBusiness });\n  }\n\n  getNewChangedLocation = async() => {\n    await Location.watchPositionAsync(\n      {\n        enableHighAccuracy: true,\n        distanceInterval: 100,\n        timeInterval: 5000\n      },\n      newLocation => {\n        let { coords } = newLocation;\n        this.props.setUserLocation(coords);\n      },\n      error => console.log(error)\n    );\n  }\n\n  getCurrentLocation = async() => {\n    let { status } = await Location.requestPermissionsAsync();\n    if (status !== 'granted') {\n      setErrorMsg('Permission to access location was denied');\n    }\n    let location = await Location.getCurrentPositionAsync({\n      accuracy: Location.Accuracy.Balanced\n    });\n    return location;\n  }\n    \n  render() {  \n    const {navigation} = this.props;\n    return (\n      <SafeAreaView style = {{ flex: 1 }} >\n        <View style={{ flex: 1 }}>\n          <MapComponent navigation = {navigation}/>\n          { this.state.showModal &&  <ShowPopupModal  closeModal = {()=> this.setState({ showModal: false })} navigation = {this.props.navigation} /> } \n          { this.state.showProfileModal && <Modal  item  = {this.state.selectedItem}  businessData = {this.state.selectedBusiness}  show = {this.state.showProfileModal} closeModal = {()=> { this.setState({ showProfileModal: false }) }} />  }   \n          <OrientationLoadingOverlay\n            visible={this.state.spinner}\n            message = \"Loading...\"\n            color=\"white\"\n            indicatorSize=\"large\"\n            messageFontSize={24}\n          >\n          <View>\n            <Image\n              source={require('../../assets/loadingIndicator.gif')}\n            />\n          </View>\n        </OrientationLoadingOverlay>         \n        </View>\n      </SafeAreaView>    \n    );\n  }\n}\nconst mapStateToProps = (state) => {\n  const { business, vibe, user, category } = state\n  return { \n    business: business,\n    vibe: vibe,\n    category,\n    user\n  }\n};\nconst mapDispatchToProps = dispatch => (\n  bindActionCreators({\n    getNearLocationBusiness,\n    getfilteredBusiness,\n    getVibe,\n    emptyBusiness,\n    getAllCategories,\n    setUserLocation,\n    getFavouritesBusinessAction\n  }, dispatch)\n);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HomeScreen);\n\nconst styles = StyleSheet.create({\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#F5FCFF',\n  },\n  welcome: {\n    fontSize: 20,\n    textAlign: 'center',\n    margin: 10,\n  },\n  instructions: {\n    textAlign: 'center',\n    color: '#333333',\n    marginBottom: 5,\n  },\n  container: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  homeLogo: { flex: 1,\n    height: null, \n    width: '100%',\n    resizeMode: 'cover',\n    borderBottomLeftRadius:0,\n    borderBottomRightRadius:0 ,\n    borderRadius: 15,\n    borderBottomWidth: 0,\n    borderWidth: 1, \n    borderColor: '#dddddd' \n  },\n  ImageButton: {\n    position: 'absolute',\n    top: '25%',\n    left: '5%'\n  },\n  spinnerTextStyle: {\n    color: '#FFF'\n  },\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#F5FCFF'\n  },\n  welcome: {\n    fontSize: 20,\n    textAlign: 'center',\n    margin: 10\n  },\n  instructions: {\n    textAlign: 'center',\n    color: '#333333',\n    marginBottom: 5\n  },\n  spinnerContainer: {\n    position: 'relative',\n    top: '0%',\n    bottom:'40%',\n    left: '35%'\n  },\n  overlaycontainer:{\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: '#000',\n    opacity:0.3,\n    justifyContent:\"center\",\n    alignItems:\"center\",\n    zIndex: 3 \n  }\n});"]},"metadata":{},"sourceType":"module"}